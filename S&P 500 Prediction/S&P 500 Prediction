{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "8f0f1725-f02f-4c68-9b32-cdfa6d53d48a",
   "metadata": {},
   "outputs": [],
   "source": [
    "import yfinance as yf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "23f26c98-f1c8-4066-8bff-c1197111922a",
   "metadata": {},
   "outputs": [],
   "source": [
    "sp500 = yf.Ticker('^GSPC')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "1a18c2be-d329-479a-be1c-fd9da93799f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "sp500 = sp500.history(period='max')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "85d6f6f1-12d7-4386-8163-a2e478eaf33e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Dividends</th>\n",
       "      <th>Stock Splits</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1927-12-30 00:00:00-05:00</th>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-03 00:00:00-05:00</th>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-04 00:00:00-05:00</th>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-05 00:00:00-05:00</th>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-06 00:00:00-05:00</th>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-06 00:00:00-04:00</th>\n",
       "      <td>5507.330078</td>\n",
       "      <td>5522.470215</td>\n",
       "      <td>5402.620117</td>\n",
       "      <td>5408.419922</td>\n",
       "      <td>3822800000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-09 00:00:00-04:00</th>\n",
       "      <td>5442.069824</td>\n",
       "      <td>5484.200195</td>\n",
       "      <td>5434.490234</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>3825940000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-10 00:00:00-04:00</th>\n",
       "      <td>5490.509766</td>\n",
       "      <td>5497.910156</td>\n",
       "      <td>5441.720215</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>3848180000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-11 00:00:00-04:00</th>\n",
       "      <td>5496.419922</td>\n",
       "      <td>5560.410156</td>\n",
       "      <td>5406.959961</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>3839450000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-12 00:00:00-04:00</th>\n",
       "      <td>5557.479980</td>\n",
       "      <td>5600.709961</td>\n",
       "      <td>5535.500000</td>\n",
       "      <td>5595.759766</td>\n",
       "      <td>3655070000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>24291 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  Open         High          Low        Close  \\\n",
       "Date                                                                            \n",
       "1927-12-30 00:00:00-05:00    17.660000    17.660000    17.660000    17.660000   \n",
       "1928-01-03 00:00:00-05:00    17.760000    17.760000    17.760000    17.760000   \n",
       "1928-01-04 00:00:00-05:00    17.719999    17.719999    17.719999    17.719999   \n",
       "1928-01-05 00:00:00-05:00    17.549999    17.549999    17.549999    17.549999   \n",
       "1928-01-06 00:00:00-05:00    17.660000    17.660000    17.660000    17.660000   \n",
       "...                                ...          ...          ...          ...   \n",
       "2024-09-06 00:00:00-04:00  5507.330078  5522.470215  5402.620117  5408.419922   \n",
       "2024-09-09 00:00:00-04:00  5442.069824  5484.200195  5434.490234  5471.049805   \n",
       "2024-09-10 00:00:00-04:00  5490.509766  5497.910156  5441.720215  5495.520020   \n",
       "2024-09-11 00:00:00-04:00  5496.419922  5560.410156  5406.959961  5554.129883   \n",
       "2024-09-12 00:00:00-04:00  5557.479980  5600.709961  5535.500000  5595.759766   \n",
       "\n",
       "                               Volume  Dividends  Stock Splits  \n",
       "Date                                                            \n",
       "1927-12-30 00:00:00-05:00           0        0.0           0.0  \n",
       "1928-01-03 00:00:00-05:00           0        0.0           0.0  \n",
       "1928-01-04 00:00:00-05:00           0        0.0           0.0  \n",
       "1928-01-05 00:00:00-05:00           0        0.0           0.0  \n",
       "1928-01-06 00:00:00-05:00           0        0.0           0.0  \n",
       "...                               ...        ...           ...  \n",
       "2024-09-06 00:00:00-04:00  3822800000        0.0           0.0  \n",
       "2024-09-09 00:00:00-04:00  3825940000        0.0           0.0  \n",
       "2024-09-10 00:00:00-04:00  3848180000        0.0           0.0  \n",
       "2024-09-11 00:00:00-04:00  3839450000        0.0           0.0  \n",
       "2024-09-12 00:00:00-04:00  3655070000        0.0           0.0  \n",
       "\n",
       "[24291 rows x 7 columns]"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp500"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "3437983f-38bb-41ce-a605-194b11272764",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "DatetimeIndex(['1927-12-30 00:00:00-05:00', '1928-01-03 00:00:00-05:00',\n",
       "               '1928-01-04 00:00:00-05:00', '1928-01-05 00:00:00-05:00',\n",
       "               '1928-01-06 00:00:00-05:00', '1928-01-09 00:00:00-05:00',\n",
       "               '1928-01-10 00:00:00-05:00', '1928-01-11 00:00:00-05:00',\n",
       "               '1928-01-12 00:00:00-05:00', '1928-01-13 00:00:00-05:00',\n",
       "               ...\n",
       "               '2024-08-29 00:00:00-04:00', '2024-08-30 00:00:00-04:00',\n",
       "               '2024-09-03 00:00:00-04:00', '2024-09-04 00:00:00-04:00',\n",
       "               '2024-09-05 00:00:00-04:00', '2024-09-06 00:00:00-04:00',\n",
       "               '2024-09-09 00:00:00-04:00', '2024-09-10 00:00:00-04:00',\n",
       "               '2024-09-11 00:00:00-04:00', '2024-09-12 00:00:00-04:00'],\n",
       "              dtype='datetime64[ns, America/New_York]', name='Date', length=24291, freq=None)"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp500.index"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e0846e30-b83e-4870-8556-b160b6f638ca",
   "metadata": {},
   "source": [
    "### Cleaning and Visualising Stock Market Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "fdc54d40-a38d-4b06-ac44-2cb7d98e42e2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Axes: xlabel='Date'>"
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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xQoAwNKlSxEbGws/Pz9ERkZi+vTpKCgoAABs374dTz75JHQ6nTSqM3/+fACAXq/H3Llz0aJFC/j5+SEuLg7bt293zIESUaNjiCEip3PPPfega9eu+P777wEAcrkc77//Po4dO4aVK1di27ZtmDt3LgCgT58+ePfddxEQEICMjAxkZGRgzpw5AIAnn3wSu3btwtq1a3HkyBE89NBDGD58OM6cOeOwYyOixsMbQBKRw0yaNAm5ublYv3691b7x48fjyJEjOHHihNW+b7/9Fs888wyuXbsGoGxOTGJiInJzc6U2586dQ3R0NC5fvoyIiAhp++DBg9GrVy8sXry40Y+HiOxL6egCiIgqI4SATCYDAPz6669YvHgxTpw4gby8PBiNRpSUlKCwsBB+fn6Vvv7w4cMQQqBdu3YW20tLSxEcHGzz+onI9hhiiMgppaWlISoqCn/++SfuvfdeTJs2Df/85z8RFBSEnTt34qmnnoLBYKjy9WazGQqFAocOHYJCobDY16RJE1uXT0R2wBBDRE5n27ZtOHr0KP7+97/j4MGDMBqNePvttyGXl03j++abbyzae3l5wWQyWWy74447YDKZkJWVhX79+tmtdiKyH4YYInKo0tJSaLVamEwmZGZmIiUlBUlJSRg1ahQef/xxHD16FEajER988AHuu+8+7Nq1Cx9//LHFe7Rp0wYFBQXYunUrunbtCl9fX7Rr1w4TJ07E448/jrfffht33HEHrl27hm3btiE2Nhb33nuvg46YiBoLr04iIodKSUlB8+bN0aZNGwwfPhy//vor3n//ffzwww9QKBTo1q0bli5dijfffBMxMTFYvXo1kpKSLN6jT58+mDZtGh555BGEhIRgyZIlAIDPP/8cjz/+OGbPno327dtj9OjR2LdvHyIjIx1xqETUyHh1EhEREbkkjsQQERGRS2KIISIiIpfEEENEREQuiSGGiIiIXBJDDBEREbkkhhgiIiJySQwxRERE5JIYYoiIiMglMcQQERGRS2KIISIiIpfEEENEREQu6f8Dye6vXaSBedkAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "sp500.plot.line(y='Close', use_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "31793019-6c70-4261-8e3c-28a9d9c5e967",
   "metadata": {},
   "outputs": [],
   "source": [
    "del sp500['Dividends']\n",
    "del sp500['Stock Splits']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a3ee6b7b-f91f-49cb-bf56-b540240072ad",
   "metadata": {},
   "source": [
    "### Setting up Target for Machine Learning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "2cac261a-3132-4f1d-8fa1-667f793ba237",
   "metadata": {},
   "outputs": [],
   "source": [
    "sp500['Tomorrow'] = sp500['Close'].shift(-1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "77ded0b1-16ae-4185-a07a-a817ff394950",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Tomorrow</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1927-12-30 00:00:00-05:00</th>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>0</td>\n",
       "      <td>17.760000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-03 00:00:00-05:00</th>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>0</td>\n",
       "      <td>17.719999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-04 00:00:00-05:00</th>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>0</td>\n",
       "      <td>17.549999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-05 00:00:00-05:00</th>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>0</td>\n",
       "      <td>17.660000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-06 00:00:00-05:00</th>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>0</td>\n",
       "      <td>17.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-06 00:00:00-04:00</th>\n",
       "      <td>5507.330078</td>\n",
       "      <td>5522.470215</td>\n",
       "      <td>5402.620117</td>\n",
       "      <td>5408.419922</td>\n",
       "      <td>3822800000</td>\n",
       "      <td>5471.049805</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-09 00:00:00-04:00</th>\n",
       "      <td>5442.069824</td>\n",
       "      <td>5484.200195</td>\n",
       "      <td>5434.490234</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>3825940000</td>\n",
       "      <td>5495.520020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-10 00:00:00-04:00</th>\n",
       "      <td>5490.509766</td>\n",
       "      <td>5497.910156</td>\n",
       "      <td>5441.720215</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>3848180000</td>\n",
       "      <td>5554.129883</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-11 00:00:00-04:00</th>\n",
       "      <td>5496.419922</td>\n",
       "      <td>5560.410156</td>\n",
       "      <td>5406.959961</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>3839450000</td>\n",
       "      <td>5595.759766</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-12 00:00:00-04:00</th>\n",
       "      <td>5557.479980</td>\n",
       "      <td>5600.709961</td>\n",
       "      <td>5535.500000</td>\n",
       "      <td>5595.759766</td>\n",
       "      <td>3655070000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>24291 rows Ã— 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  Open         High          Low        Close  \\\n",
       "Date                                                                            \n",
       "1927-12-30 00:00:00-05:00    17.660000    17.660000    17.660000    17.660000   \n",
       "1928-01-03 00:00:00-05:00    17.760000    17.760000    17.760000    17.760000   \n",
       "1928-01-04 00:00:00-05:00    17.719999    17.719999    17.719999    17.719999   \n",
       "1928-01-05 00:00:00-05:00    17.549999    17.549999    17.549999    17.549999   \n",
       "1928-01-06 00:00:00-05:00    17.660000    17.660000    17.660000    17.660000   \n",
       "...                                ...          ...          ...          ...   \n",
       "2024-09-06 00:00:00-04:00  5507.330078  5522.470215  5402.620117  5408.419922   \n",
       "2024-09-09 00:00:00-04:00  5442.069824  5484.200195  5434.490234  5471.049805   \n",
       "2024-09-10 00:00:00-04:00  5490.509766  5497.910156  5441.720215  5495.520020   \n",
       "2024-09-11 00:00:00-04:00  5496.419922  5560.410156  5406.959961  5554.129883   \n",
       "2024-09-12 00:00:00-04:00  5557.479980  5600.709961  5535.500000  5595.759766   \n",
       "\n",
       "                               Volume     Tomorrow  \n",
       "Date                                                \n",
       "1927-12-30 00:00:00-05:00           0    17.760000  \n",
       "1928-01-03 00:00:00-05:00           0    17.719999  \n",
       "1928-01-04 00:00:00-05:00           0    17.549999  \n",
       "1928-01-05 00:00:00-05:00           0    17.660000  \n",
       "1928-01-06 00:00:00-05:00           0    17.500000  \n",
       "...                               ...          ...  \n",
       "2024-09-06 00:00:00-04:00  3822800000  5471.049805  \n",
       "2024-09-09 00:00:00-04:00  3825940000  5495.520020  \n",
       "2024-09-10 00:00:00-04:00  3848180000  5554.129883  \n",
       "2024-09-11 00:00:00-04:00  3839450000  5595.759766  \n",
       "2024-09-12 00:00:00-04:00  3655070000          NaN  \n",
       "\n",
       "[24291 rows x 6 columns]"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp500"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "id": "3f20cf32-f60a-468b-b02a-fae85bbd7a07",
   "metadata": {},
   "outputs": [],
   "source": [
    "sp500['Target'] = (sp500['Tomorrow'] > sp500['Close']).astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "659c10c9-3741-4995-b04c-9c52e03fb51a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Tomorrow</th>\n",
       "      <th>Target</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1927-12-30 00:00:00-05:00</th>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>0</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-03 00:00:00-05:00</th>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>17.760000</td>\n",
       "      <td>0</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-04 00:00:00-05:00</th>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>17.719999</td>\n",
       "      <td>0</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-05 00:00:00-05:00</th>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>17.549999</td>\n",
       "      <td>0</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1928-01-06 00:00:00-05:00</th>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>17.660000</td>\n",
       "      <td>0</td>\n",
       "      <td>17.500000</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-06 00:00:00-04:00</th>\n",
       "      <td>5507.330078</td>\n",
       "      <td>5522.470215</td>\n",
       "      <td>5402.620117</td>\n",
       "      <td>5408.419922</td>\n",
       "      <td>3822800000</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-09 00:00:00-04:00</th>\n",
       "      <td>5442.069824</td>\n",
       "      <td>5484.200195</td>\n",
       "      <td>5434.490234</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>3825940000</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-10 00:00:00-04:00</th>\n",
       "      <td>5490.509766</td>\n",
       "      <td>5497.910156</td>\n",
       "      <td>5441.720215</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>3848180000</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-11 00:00:00-04:00</th>\n",
       "      <td>5496.419922</td>\n",
       "      <td>5560.410156</td>\n",
       "      <td>5406.959961</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>3839450000</td>\n",
       "      <td>5595.759766</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-12 00:00:00-04:00</th>\n",
       "      <td>5557.479980</td>\n",
       "      <td>5600.709961</td>\n",
       "      <td>5535.500000</td>\n",
       "      <td>5595.759766</td>\n",
       "      <td>3655070000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>24291 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  Open         High          Low        Close  \\\n",
       "Date                                                                            \n",
       "1927-12-30 00:00:00-05:00    17.660000    17.660000    17.660000    17.660000   \n",
       "1928-01-03 00:00:00-05:00    17.760000    17.760000    17.760000    17.760000   \n",
       "1928-01-04 00:00:00-05:00    17.719999    17.719999    17.719999    17.719999   \n",
       "1928-01-05 00:00:00-05:00    17.549999    17.549999    17.549999    17.549999   \n",
       "1928-01-06 00:00:00-05:00    17.660000    17.660000    17.660000    17.660000   \n",
       "...                                ...          ...          ...          ...   \n",
       "2024-09-06 00:00:00-04:00  5507.330078  5522.470215  5402.620117  5408.419922   \n",
       "2024-09-09 00:00:00-04:00  5442.069824  5484.200195  5434.490234  5471.049805   \n",
       "2024-09-10 00:00:00-04:00  5490.509766  5497.910156  5441.720215  5495.520020   \n",
       "2024-09-11 00:00:00-04:00  5496.419922  5560.410156  5406.959961  5554.129883   \n",
       "2024-09-12 00:00:00-04:00  5557.479980  5600.709961  5535.500000  5595.759766   \n",
       "\n",
       "                               Volume     Tomorrow  Target  \n",
       "Date                                                        \n",
       "1927-12-30 00:00:00-05:00           0    17.760000       1  \n",
       "1928-01-03 00:00:00-05:00           0    17.719999       0  \n",
       "1928-01-04 00:00:00-05:00           0    17.549999       0  \n",
       "1928-01-05 00:00:00-05:00           0    17.660000       1  \n",
       "1928-01-06 00:00:00-05:00           0    17.500000       0  \n",
       "...                               ...          ...     ...  \n",
       "2024-09-06 00:00:00-04:00  3822800000  5471.049805       1  \n",
       "2024-09-09 00:00:00-04:00  3825940000  5495.520020       1  \n",
       "2024-09-10 00:00:00-04:00  3848180000  5554.129883       1  \n",
       "2024-09-11 00:00:00-04:00  3839450000  5595.759766       1  \n",
       "2024-09-12 00:00:00-04:00  3655070000          NaN       0  \n",
       "\n",
       "[24291 rows x 7 columns]"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp500"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "id": "4c148fd2-bab9-4e09-afc5-f6e5393b0171",
   "metadata": {},
   "outputs": [],
   "source": [
    "#make sure the data isn't too far back\n",
    "sp500 = sp500.loc['1990-01-01':].copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "8d031afe-5bee-4d50-9cdc-56a273db2631",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Tomorrow</th>\n",
       "      <th>Target</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1990-01-02 00:00:00-05:00</th>\n",
       "      <td>353.399994</td>\n",
       "      <td>359.690002</td>\n",
       "      <td>351.980011</td>\n",
       "      <td>359.690002</td>\n",
       "      <td>162070000</td>\n",
       "      <td>358.760010</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-01-03 00:00:00-05:00</th>\n",
       "      <td>359.690002</td>\n",
       "      <td>360.589996</td>\n",
       "      <td>357.890015</td>\n",
       "      <td>358.760010</td>\n",
       "      <td>192330000</td>\n",
       "      <td>355.670013</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-01-04 00:00:00-05:00</th>\n",
       "      <td>358.760010</td>\n",
       "      <td>358.760010</td>\n",
       "      <td>352.890015</td>\n",
       "      <td>355.670013</td>\n",
       "      <td>177000000</td>\n",
       "      <td>352.200012</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-01-05 00:00:00-05:00</th>\n",
       "      <td>355.670013</td>\n",
       "      <td>355.670013</td>\n",
       "      <td>351.350006</td>\n",
       "      <td>352.200012</td>\n",
       "      <td>158530000</td>\n",
       "      <td>353.790009</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-01-08 00:00:00-05:00</th>\n",
       "      <td>352.200012</td>\n",
       "      <td>354.239990</td>\n",
       "      <td>350.540009</td>\n",
       "      <td>353.790009</td>\n",
       "      <td>140110000</td>\n",
       "      <td>349.619995</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-06 00:00:00-04:00</th>\n",
       "      <td>5507.330078</td>\n",
       "      <td>5522.470215</td>\n",
       "      <td>5402.620117</td>\n",
       "      <td>5408.419922</td>\n",
       "      <td>3822800000</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-09 00:00:00-04:00</th>\n",
       "      <td>5442.069824</td>\n",
       "      <td>5484.200195</td>\n",
       "      <td>5434.490234</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>3825940000</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-10 00:00:00-04:00</th>\n",
       "      <td>5490.509766</td>\n",
       "      <td>5497.910156</td>\n",
       "      <td>5441.720215</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>3848180000</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-11 00:00:00-04:00</th>\n",
       "      <td>5496.419922</td>\n",
       "      <td>5560.410156</td>\n",
       "      <td>5406.959961</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>3839450000</td>\n",
       "      <td>5595.759766</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-12 00:00:00-04:00</th>\n",
       "      <td>5557.479980</td>\n",
       "      <td>5600.709961</td>\n",
       "      <td>5535.500000</td>\n",
       "      <td>5595.759766</td>\n",
       "      <td>3655070000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8741 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  Open         High          Low        Close  \\\n",
       "Date                                                                            \n",
       "1990-01-02 00:00:00-05:00   353.399994   359.690002   351.980011   359.690002   \n",
       "1990-01-03 00:00:00-05:00   359.690002   360.589996   357.890015   358.760010   \n",
       "1990-01-04 00:00:00-05:00   358.760010   358.760010   352.890015   355.670013   \n",
       "1990-01-05 00:00:00-05:00   355.670013   355.670013   351.350006   352.200012   \n",
       "1990-01-08 00:00:00-05:00   352.200012   354.239990   350.540009   353.790009   \n",
       "...                                ...          ...          ...          ...   \n",
       "2024-09-06 00:00:00-04:00  5507.330078  5522.470215  5402.620117  5408.419922   \n",
       "2024-09-09 00:00:00-04:00  5442.069824  5484.200195  5434.490234  5471.049805   \n",
       "2024-09-10 00:00:00-04:00  5490.509766  5497.910156  5441.720215  5495.520020   \n",
       "2024-09-11 00:00:00-04:00  5496.419922  5560.410156  5406.959961  5554.129883   \n",
       "2024-09-12 00:00:00-04:00  5557.479980  5600.709961  5535.500000  5595.759766   \n",
       "\n",
       "                               Volume     Tomorrow  Target  \n",
       "Date                                                        \n",
       "1990-01-02 00:00:00-05:00   162070000   358.760010       0  \n",
       "1990-01-03 00:00:00-05:00   192330000   355.670013       0  \n",
       "1990-01-04 00:00:00-05:00   177000000   352.200012       0  \n",
       "1990-01-05 00:00:00-05:00   158530000   353.790009       1  \n",
       "1990-01-08 00:00:00-05:00   140110000   349.619995       0  \n",
       "...                               ...          ...     ...  \n",
       "2024-09-06 00:00:00-04:00  3822800000  5471.049805       1  \n",
       "2024-09-09 00:00:00-04:00  3825940000  5495.520020       1  \n",
       "2024-09-10 00:00:00-04:00  3848180000  5554.129883       1  \n",
       "2024-09-11 00:00:00-04:00  3839450000  5595.759766       1  \n",
       "2024-09-12 00:00:00-04:00  3655070000          NaN       0  \n",
       "\n",
       "[8741 rows x 7 columns]"
      ]
     },
     "execution_count": 81,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp500"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c133fde1-9de4-4f4d-b88b-62ffccadeddd",
   "metadata": {},
   "source": [
    "### Training an Initial Machine Learning Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "id": "546bf812-3642-4f5d-8fa7-aad44c087db2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-5 {\n",
       "  /* Definition of color scheme common for light and dark mode */\n",
       "  --sklearn-color-text: black;\n",
       "  --sklearn-color-line: gray;\n",
       "  /* Definition of color scheme for unfitted estimators */\n",
       "  --sklearn-color-unfitted-level-0: #fff5e6;\n",
       "  --sklearn-color-unfitted-level-1: #f6e4d2;\n",
       "  --sklearn-color-unfitted-level-2: #ffe0b3;\n",
       "  --sklearn-color-unfitted-level-3: chocolate;\n",
       "  /* Definition of color scheme for fitted estimators */\n",
       "  --sklearn-color-fitted-level-0: #f0f8ff;\n",
       "  --sklearn-color-fitted-level-1: #d4ebff;\n",
       "  --sklearn-color-fitted-level-2: #b3dbfd;\n",
       "  --sklearn-color-fitted-level-3: cornflowerblue;\n",
       "\n",
       "  /* Specific color for light theme */\n",
       "  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
       "  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n",
       "  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
       "  --sklearn-color-icon: #696969;\n",
       "\n",
       "  @media (prefers-color-scheme: dark) {\n",
       "    /* Redefinition of color scheme for dark theme */\n",
       "    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
       "    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n",
       "    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
       "    --sklearn-color-icon: #878787;\n",
       "  }\n",
       "}\n",
       "\n",
       "#sk-container-id-5 {\n",
       "  color: var(--sklearn-color-text);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 pre {\n",
       "  padding: 0;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 input.sk-hidden--visually {\n",
       "  border: 0;\n",
       "  clip: rect(1px 1px 1px 1px);\n",
       "  clip: rect(1px, 1px, 1px, 1px);\n",
       "  height: 1px;\n",
       "  margin: -1px;\n",
       "  overflow: hidden;\n",
       "  padding: 0;\n",
       "  position: absolute;\n",
       "  width: 1px;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-dashed-wrapped {\n",
       "  border: 1px dashed var(--sklearn-color-line);\n",
       "  margin: 0 0.4em 0.5em 0.4em;\n",
       "  box-sizing: border-box;\n",
       "  padding-bottom: 0.4em;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-container {\n",
       "  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n",
       "     but bootstrap.min.css set `[hidden] { display: none !important; }`\n",
       "     so we also need the `!important` here to be able to override the\n",
       "     default hidden behavior on the sphinx rendered scikit-learn.org.\n",
       "     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n",
       "  display: inline-block !important;\n",
       "  position: relative;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-text-repr-fallback {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       "div.sk-parallel-item,\n",
       "div.sk-serial,\n",
       "div.sk-item {\n",
       "  /* draw centered vertical line to link estimators */\n",
       "  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n",
       "  background-size: 2px 100%;\n",
       "  background-repeat: no-repeat;\n",
       "  background-position: center center;\n",
       "}\n",
       "\n",
       "/* Parallel-specific style estimator block */\n",
       "\n",
       "#sk-container-id-5 div.sk-parallel-item::after {\n",
       "  content: \"\";\n",
       "  width: 100%;\n",
       "  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n",
       "  flex-grow: 1;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-parallel {\n",
       "  display: flex;\n",
       "  align-items: stretch;\n",
       "  justify-content: center;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  position: relative;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-parallel-item {\n",
       "  display: flex;\n",
       "  flex-direction: column;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-parallel-item:first-child::after {\n",
       "  align-self: flex-end;\n",
       "  width: 50%;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-parallel-item:last-child::after {\n",
       "  align-self: flex-start;\n",
       "  width: 50%;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-parallel-item:only-child::after {\n",
       "  width: 0;\n",
       "}\n",
       "\n",
       "/* Serial-specific style estimator block */\n",
       "\n",
       "#sk-container-id-5 div.sk-serial {\n",
       "  display: flex;\n",
       "  flex-direction: column;\n",
       "  align-items: center;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  padding-right: 1em;\n",
       "  padding-left: 1em;\n",
       "}\n",
       "\n",
       "\n",
       "/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n",
       "clickable and can be expanded/collapsed.\n",
       "- Pipeline and ColumnTransformer use this feature and define the default style\n",
       "- Estimators will overwrite some part of the style using the `sk-estimator` class\n",
       "*/\n",
       "\n",
       "/* Pipeline and ColumnTransformer style (default) */\n",
       "\n",
       "#sk-container-id-5 div.sk-toggleable {\n",
       "  /* Default theme specific background. It is overwritten whether we have a\n",
       "  specific estimator or a Pipeline/ColumnTransformer */\n",
       "  background-color: var(--sklearn-color-background);\n",
       "}\n",
       "\n",
       "/* Toggleable label */\n",
       "#sk-container-id-5 label.sk-toggleable__label {\n",
       "  cursor: pointer;\n",
       "  display: block;\n",
       "  width: 100%;\n",
       "  margin-bottom: 0;\n",
       "  padding: 0.5em;\n",
       "  box-sizing: border-box;\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 label.sk-toggleable__label-arrow:before {\n",
       "  /* Arrow on the left of the label */\n",
       "  content: \"â–¸\";\n",
       "  float: left;\n",
       "  margin-right: 0.25em;\n",
       "  color: var(--sklearn-color-icon);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {\n",
       "  color: var(--sklearn-color-text);\n",
       "}\n",
       "\n",
       "/* Toggleable content - dropdown */\n",
       "\n",
       "#sk-container-id-5 div.sk-toggleable__content {\n",
       "  max-height: 0;\n",
       "  max-width: 0;\n",
       "  overflow: hidden;\n",
       "  text-align: left;\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-toggleable__content.fitted {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-toggleable__content pre {\n",
       "  margin: 0.2em;\n",
       "  border-radius: 0.25em;\n",
       "  color: var(--sklearn-color-text);\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-toggleable__content.fitted pre {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n",
       "  /* Expand drop-down */\n",
       "  max-height: 200px;\n",
       "  max-width: 100%;\n",
       "  overflow: auto;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n",
       "  content: \"â–¾\";\n",
       "}\n",
       "\n",
       "/* Pipeline/ColumnTransformer-specific style */\n",
       "\n",
       "#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Estimator-specific style */\n",
       "\n",
       "/* Colorize estimator box */\n",
       "#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-label label.sk-toggleable__label,\n",
       "#sk-container-id-5 div.sk-label label {\n",
       "  /* The background is the default theme color */\n",
       "  color: var(--sklearn-color-text-on-default-background);\n",
       "}\n",
       "\n",
       "/* On hover, darken the color of the background */\n",
       "#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "/* Label box, darken color on hover, fitted */\n",
       "#sk-container-id-5 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Estimator label */\n",
       "\n",
       "#sk-container-id-5 div.sk-label label {\n",
       "  font-family: monospace;\n",
       "  font-weight: bold;\n",
       "  display: inline-block;\n",
       "  line-height: 1.2em;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-label-container {\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       "/* Estimator-specific */\n",
       "#sk-container-id-5 div.sk-estimator {\n",
       "  font-family: monospace;\n",
       "  border: 1px dotted var(--sklearn-color-border-box);\n",
       "  border-radius: 0.25em;\n",
       "  box-sizing: border-box;\n",
       "  margin-bottom: 0.5em;\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-estimator.fitted {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "/* on hover */\n",
       "#sk-container-id-5 div.sk-estimator:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-5 div.sk-estimator.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Specification for estimator info (e.g. \"i\" and \"?\") */\n",
       "\n",
       "/* Common style for \"i\" and \"?\" */\n",
       "\n",
       ".sk-estimator-doc-link,\n",
       "a:link.sk-estimator-doc-link,\n",
       "a:visited.sk-estimator-doc-link {\n",
       "  float: right;\n",
       "  font-size: smaller;\n",
       "  line-height: 1em;\n",
       "  font-family: monospace;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  border-radius: 1em;\n",
       "  height: 1em;\n",
       "  width: 1em;\n",
       "  text-decoration: none !important;\n",
       "  margin-left: 1ex;\n",
       "  /* unfitted */\n",
       "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-unfitted-level-1);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link.fitted,\n",
       "a:link.sk-estimator-doc-link.fitted,\n",
       "a:visited.sk-estimator-doc-link.fitted {\n",
       "  /* fitted */\n",
       "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-fitted-level-1);\n",
       "}\n",
       "\n",
       "/* On hover */\n",
       "div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",
       ".sk-estimator-doc-link:hover,\n",
       "div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",
       ".sk-estimator-doc-link:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",
       ".sk-estimator-doc-link.fitted:hover,\n",
       "div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",
       ".sk-estimator-doc-link.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "/* Span, style for the box shown on hovering the info icon */\n",
       ".sk-estimator-doc-link span {\n",
       "  display: none;\n",
       "  z-index: 9999;\n",
       "  position: relative;\n",
       "  font-weight: normal;\n",
       "  right: .2ex;\n",
       "  padding: .5ex;\n",
       "  margin: .5ex;\n",
       "  width: min-content;\n",
       "  min-width: 20ex;\n",
       "  max-width: 50ex;\n",
       "  color: var(--sklearn-color-text);\n",
       "  box-shadow: 2pt 2pt 4pt #999;\n",
       "  /* unfitted */\n",
       "  background: var(--sklearn-color-unfitted-level-0);\n",
       "  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link.fitted span {\n",
       "  /* fitted */\n",
       "  background: var(--sklearn-color-fitted-level-0);\n",
       "  border: var(--sklearn-color-fitted-level-3);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link:hover span {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       "/* \"?\"-specific style due to the `<a>` HTML tag */\n",
       "\n",
       "#sk-container-id-5 a.estimator_doc_link {\n",
       "  float: right;\n",
       "  font-size: 1rem;\n",
       "  line-height: 1em;\n",
       "  font-family: monospace;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  border-radius: 1rem;\n",
       "  height: 1rem;\n",
       "  width: 1rem;\n",
       "  text-decoration: none;\n",
       "  /* unfitted */\n",
       "  color: var(--sklearn-color-unfitted-level-1);\n",
       "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 a.estimator_doc_link.fitted {\n",
       "  /* fitted */\n",
       "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-fitted-level-1);\n",
       "}\n",
       "\n",
       "/* On hover */\n",
       "#sk-container-id-5 a.estimator_doc_link:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "#sk-container-id-5 a.estimator_doc_link.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-3);\n",
       "}\n",
       "</style><div id=\"sk-container-id-5\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestClassifier(min_samples_split=100, random_state=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" checked><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow fitted\">&nbsp;&nbsp;RandomForestClassifier<a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestClassifier.html\">?<span>Documentation for RandomForestClassifier</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></label><div class=\"sk-toggleable__content fitted\"><pre>RandomForestClassifier(min_samples_split=100, random_state=1)</pre></div> </div></div></div></div>"
      ],
      "text/plain": [
       "RandomForestClassifier(min_samples_split=100, random_state=1)"
      ]
     },
     "execution_count": 82,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "model = RandomForestClassifier(n_estimators=100, min_samples_split=100, random_state=1)\n",
    "\n",
    "#splitting the dataset based on the first and last 1000 rows\n",
    "train = sp500.iloc[:-1000]\n",
    "test = sp500.iloc[-1000:]\n",
    "\n",
    "predictors = ['Close', 'Volume', 'Open', 'High', 'Low']\n",
    "model.fit(train[predictors], train['Target'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "28fd7668-6615-4888-a7f7-c0fa7db9461d",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import precision_score\n",
    "\n",
    "#generating predictions using predict method on the model and using the test set with the predictors\n",
    "preds = model.predict(test[predictors])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "id": "7f44426a-f2ed-4d7a-9cf0-d52afd6cb5ab",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "preds = pd.Series(preds, index=test.index)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "id": "963223de-fb6f-468e-a32a-2a9aa3d3cb4f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.5119047619047619"
      ]
     },
     "execution_count": 85,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "precision_score(test['Target'],preds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "id": "a19af4a5-cd64-4883-9485-37f778b9ebe0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Target\n",
      "1    527\n",
      "0    473\n",
      "Name: count, dtype: int64\n",
      "Confusion Matrix:\n",
      " [[268 205]\n",
      " [312 215]]\n",
      "Classification Report:\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           0       0.46      0.57      0.51       473\n",
      "           1       0.51      0.41      0.45       527\n",
      "\n",
      "    accuracy                           0.48      1000\n",
      "   macro avg       0.49      0.49      0.48      1000\n",
      "weighted avg       0.49      0.48      0.48      1000\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Check distribution of the target in the test set\n",
    "print(test['Target'].value_counts())\n",
    "\n",
    "# Generate confusion matrix\n",
    "from sklearn.metrics import confusion_matrix\n",
    "cm = confusion_matrix(test['Target'], preds)\n",
    "print(\"Confusion Matrix:\\n\", cm)\n",
    "\n",
    "# Display classification report for detailed evaluation\n",
    "from sklearn.metrics import classification_report\n",
    "print(\"Classification Report:\\n\", classification_report(test['Target'], preds))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "id": "ff90723f-15f4-470b-a660-3eafd6ad4cac",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined = pd.concat([test['Target'], preds], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "3c1757a0-21ec-4775-8693-2c88cf95bea5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[<Axes: title={'center': 'Target'}>,\n",
       "        <Axes: title={'center': '0'}>]], dtype=object)"
      ]
     },
     "execution_count": 98,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAi4AAAGxCAYAAABFkj3UAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAAA5yElEQVR4nO3df3RU9Z3/8deQTCYkJpEEzSQ1YtSAxYQtDTYQ2xJLfkhF6rJbXEHFLt2TFsuaQhZF2u1Q6aCcFWiD0uJJDZWDaV1Mf5wFTDhKKJtaQ4QuoEVtEWGbmINGkpA4GZP7/YPvzDrkdzIk8wnPxzk5x/uZz3zufTszn3nxmblzbZZlWQIAADDAuNE+AAAAgIEiuAAAAGMQXAAAgDEILgAAwBgEFwAAYAyCCwAAMAbBBQAAGIPgAgAAjEFwAQAAxiC4XOZsNtuA/vbv3z/ahxrgjTfekMvl0rvvvjvahwJgFLS2tqqoqEjJycmKjIzU5z73OZWXl4/2YWEEhI/2AWB0/eEPfwjYfuyxx/TKK6/o5ZdfDmifOnXqSB5Wv9544w2tXbtWOTk5uu6660b7cACMsAULFqi2tlaPP/64Jk+erJ07d+qee+5RV1eXFi1aNNqHh0uI4HKZmzlzZsD2VVddpXHjxnVrH6q2tjZFRUUFZSwAkKTdu3erqqrKH1Yk6bbbbtOpU6f0b//2b7r77rsVFhY2ykeJS4WPitCvp556Sl/+8pd19dVXKzo6WhkZGdqwYYO8Xm9Av5ycHKWnp+vAgQPKzs5WVFSU/vmf/1mSdObMGf3jP/6jYmJidOWVV2rx4sWqra2VzWZTWVlZwDiHDh3S/PnzFR8fr8jISE2fPl2/+tWv/LeXlZXp61//uqQLk5Xv46yLxwEwNlVUVOiKK67wzwM+3/jGN/S3v/1Nf/zjH0fpyDASWHFBv/7yl79o0aJFSk1NVUREhP70pz/pRz/6kf785z/r5z//eUDf+vp63XvvvVq1apXcbrfGjRun8+fP67bbbtOHH36oJ554QjfeeKP27t2ru+++u9u+XnnlFd1+++3KysrST3/6U8XFxam8vFx333232tra9MADD+iOO+6Q2+3Wo48+qqeeekqf//znJUk33HDDiPz/ADC6jh07ps9+9rMKDw98C5s2bZr/9uzs7NE4NIwAggv6tXHjRv9/d3V16Utf+pISEhL0jW98Q08++aQmTJjgv/3DDz/UCy+8oK985Sv+tqefflrvvPOO9uzZo9tvv12SlJ+fr7a2Nv3sZz8L2NeyZct088036+WXX/ZPSgUFBTp79qweffRR3X///brqqquUlpYm6cJ3b4L1sRYAM3zwwQe6/vrru7XHx8f7b8fYxUdF6Nfhw4c1f/58JSQkKCwsTHa7Xffff786Ozv11ltvBfSdMGFCQGiRpOrqasXExPhDi4/vs2mfd955R3/+85+1ePFiSdInn3zi//vqV7+q+vp6nThx4hJUCMA0NpttSLfBfKy4oE/vvfeevvSlL2nKlCn68Y9/rOuuu06RkZF67bXX9OCDD6q9vT2gf1JSUrcxPvjgAyUmJnZrv7jt/ffflyQVFxeruLi4x+M5e/bsUEsBMEYkJCT0uKry4YcfSvq/lReMTQQX9OnXv/61zp8/rxdffFGTJk3ytx85cqTH/j39SychIUGvvfZat/aGhoaA7YkTJ0qSVq9erQULFvQ4/pQpUwZ66ADGqIyMDD3//PP65JNPAr7ncvToUUlSenr6aB0aRgAfFaFPviDicDj8bZZl6ZlnnhnwGLNnz1ZLS4v27NkT0H7xj0VNmTJFaWlp+tOf/qQZM2b0+BcTExNwPBev+AAY+/7+7/9era2t2rVrV0D79u3blZycrKysrFE6MowEVlzQp7y8PEVEROiee+7RqlWr9PHHH2vr1q1qamoa8BhLlizRpk2bdO+992rdunW68cYbtWfPHr300kuSpHHj/i8//+xnP9PcuXNVUFCgBx54QJ/5zGf04Ycf6s0339Trr7+uF154QdL//Ytq27ZtiomJUWRkpFJTU5WQkBDE6gGEorlz5yovL0/f/va31dzcrBtvvFHPP/+89u7dqx07dvAbLmMcKy7o00033aRdu3apqalJCxYs0PLly/W5z31OP/nJTwY8RnR0tF5++WXl5ORo1apV+od/+Ae99957evrppyVJV155pb/vbbfdptdee01XXnmlioqKlJubq29/+9vat2+fcnNz/f1SU1O1efNm/elPf1JOTo5uueUW/e53vwta3QBC24svvqj77rtP//7v/67bb79df/zjH/X888/7v9yPsctmWZY12geBy5Pb7db3vvc9vffee7rmmmtG+3AAAAbgoyKMiC1btki6sILj9Xr18ssv6yc/+YnuvfdeQgsA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QEhav369bDabioqK/G2WZcnlcik5OVnjx49XTk6Ojh8/HnA/j8ej5cuXa+LEiYqOjtb8+fN15syZET56AJcKwQVAyKmtrdW2bds0bdq0gPYNGzZo48aN2rJli2pra+V0OpWXl6eWlhZ/n6KiIlVUVKi8vFwHDx5Ua2ur5s2bp87OzpEuA8AlQHABEFJaW1u1ePFiPfPMM5owYYK/3bIsbd68WWvWrNGCBQuUnp6u7du3q62tTTt37pQknTt3TqWlpXryySeVm5ur6dOna8eOHTp69Kj27ds3WiUBCCKuVQQgpDz44IO64447lJubq3Xr1vnbT548qYaGBuXn5/vbHA6HZs+erZqaGhUWFqqurk5erzegT3JystLT01VTU6OCgoIe9+nxeOTxePzbzc3NkiSv1yuv19vjfXztjnHW0IvtZcyR5NvnaOw7WKhh6BxhwXv++l4LfdUQjPoILgBCRnl5uV5//XXV1tZ2u62hoUGSlJiYGNCemJioU6dO+ftEREQErNT4+vju35P169dr7dq13dorKysVFRXV5zE/NqOrz9sHY/fu3UEba7CqqqpGbd/BQg2DdykuithXDW1tbcMen+ACICScPn1aDz30kCorKxUZGdlrP5vNFrBtWVa3tov112f16tVasWKFf7u5uVkpKSnKz89XbGxsj/fxer2qqqrS9w+Nk6er7/0P1DFXzytCl5Kvjry8PNnt9hHffzBQw9Clu14K2liOcZYem9HVZw2+1czhILgACAl1dXVqbGxUZmamv62zs1MHDhzQli1bdOLECUkXVlWSkpL8fRobG/2rME6nUx0dHWpqagpYdWlsbFR2dnav+3Y4HHI4HN3a7XZ7v28ini6bPJ3BCS6j+aY7kFpDHTUMXrCeu5/WVw3BqI0v5wIICXPmzNHRo0d15MgR/9+MGTO0ePFiHTlyRNdff72cTmfAMnRHR4eqq6v9oSQzM1N2uz2gT319vY4dO9ZncAFgDlZcAISEmJgYpaenB7RFR0crISHB315UVCS32620tDSlpaXJ7XYrKipKixYtkiTFxcVp6dKlWrlypRISEhQfH6/i4mJlZGQoNzd3xGsCEHwEFwDGWLVqldrb27Vs2TI1NTUpKytLlZWViomJ8ffZtGmTwsPDtXDhQrW3t2vOnDkqKytTWFjYKB45gGAhuAAIWfv37w/Yttlscrlc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IdQwvzC/BMvlOL9II/x6GNRXeUeZ7xSz0tJS64033rCKioqs6Oho/zevH3nkEeu+++7z9/ednvXd737XeuONN6zS0tJup2f993//txUWFmY9/vjj1ptvvmk9/vjjI3Ka3EBr2LlzpxUeHm499dRTAafAffTRR/4+LpfL2rt3r/WXv/zFOnz4sPWNb3zDCg8Pt/74xz+GRA2bNm2yKioqrLfeess6duyY9cgjj1iSrF27dvn7hPrj4HPvvfdaWVlZPY45ko9DS0uLdfjwYevw4cOWJGvjxo3W4cOH/adbmvBaCDXML8wvo1WDT6jML5YV2nOMUcHFsizrqaeesiZNmmRFRERYn//8563q6mr/bUuWLLFmz54d0H///v3W9OnTrYiICOu6666ztm7d2m3MF154wZoyZYplt9utm266KeAJP9o1zJ4925LU7W/JkiX+PkVFRda1115rRUREWFdddZWVn59v1dTUhEwNTzzxhHXDDTdYkZGR1oQJE6wvfvGL1n/91391GzOUHwfLuvBbC+PHj7e2bdvW43gj+Tj4TgHt7Xlhymsh1DC/ML+MRg2WFVrzi2WF9hxjs6z//+0ZAACAEGfMd1wAAAAILgAAwBgEFwAAYAyCCwAAMAbBBQAAGIPgAgAAjEFwAQAAxiC4AAAAYxBcAACAMQguAADAGAQXAABgjP8H1U/asO8sX94AAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "combined.hist()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4500cd1f-11dd-4b41-ac56-dc7130c7019f",
   "metadata": {},
   "source": [
    "### Building a Backtesting System"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "0e252612-7072-45f5-8502-b7173fe5d1e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#building a better way to test the algorithm - testing across multiple years of data\n",
    "\n",
    "def predict(train, test, predictors, model):\n",
    "    model.fit(train[predictors], train['Target'])\n",
    "    preds = model.predict(test[predictors])\n",
    "    preds = pd.Series(preds, index=test.index, name='Predictions')\n",
    "    combined = pd.concat([test['Target'], preds], axis=1)\n",
    "    return combined "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "ffd87067-fb4c-4278-a0ad-0384850faa7d",
   "metadata": {},
   "outputs": [],
   "source": [
    "def backtest(data, model, predictors, start=2500, step=250):\n",
    "    all_predictions = []\n",
    "\n",
    "    for i in range(start, data.shape[0], step):\n",
    "        train = data.iloc[0:i].copy()\n",
    "        test = data.iloc[i:(i+step)].copy()\n",
    "        predictions = predict(train, test, predictors, model)\n",
    "        all_predictions.append(predictions)\n",
    "    return pd.concat(all_predictions)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "20de22d0-f6f2-4f2b-a5ad-950db98fb474",
   "metadata": {},
   "outputs": [],
   "source": [
    "predictions = backtest(sp500, model, predictors)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "4c198751-f933-4d1f-8baa-6a1117aacac3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Predictions\n",
       "0    3645\n",
       "1    2596\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 110,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predictions['Predictions'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "3c77ea18-aa92-438e-a7c3-564288be9d98",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.5288906009244992"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "precision_score(predictions['Target'], predicitons['Predictions'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "93358809-5892-486a-aa54-72487b4ff779",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Target\n",
       "1    0.535491\n",
       "0    0.464509\n",
       "Name: count, dtype: float64"
      ]
     },
     "execution_count": 112,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predictions['Target'].value_counts() / predictions.shape[0]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a4c54f28-25b1-4f22-9b6b-6a0b91c6f8fe",
   "metadata": {},
   "source": [
    "### Adding Additional Predictors To Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "94d999fc-82fc-4e73-a8c8-a674c68a205e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#creating a variety of rolling averages and give it to the algorthim \n",
    "\n",
    "horizons = [2,5,60,250,1000]\n",
    "new_predictors = []\n",
    "\n",
    "for horizon in horizons:\n",
    "    rolling_averages = sp500.rolling(horizon).mean()\n",
    "\n",
    "    ratio_column = f'Close_Ratio_{horizon}'\n",
    "    sp500[ratio_column] = sp500['Close'] / rolling_averages['Close']\n",
    "\n",
    "    trend_column = f'Trend_{horizon}'\n",
    "    sp500[trend_column] = sp500.shift(1).rolling(horizon).sum()['Target']\n",
    "\n",
    "    new_predictors += [ratio_column, trend_column]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "8d9700fe-9709-45cb-813a-ad8758376279",
   "metadata": {},
   "outputs": [],
   "source": [
    "sp500 = sp500.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "af46f247-e865-4436-a286-dadcafe9a243",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Tomorrow</th>\n",
       "      <th>Target</th>\n",
       "      <th>Close_Ratio_2</th>\n",
       "      <th>Trend_2</th>\n",
       "      <th>Close_Ratio_5</th>\n",
       "      <th>Trend_5</th>\n",
       "      <th>Close_Ratio_60</th>\n",
       "      <th>Trend_60</th>\n",
       "      <th>Close_Ratio_250</th>\n",
       "      <th>Trend_250</th>\n",
       "      <th>Close_Ratio_1000</th>\n",
       "      <th>Trend_1000</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1993-12-14 00:00:00-05:00</th>\n",
       "      <td>465.730011</td>\n",
       "      <td>466.119995</td>\n",
       "      <td>462.459991</td>\n",
       "      <td>463.059998</td>\n",
       "      <td>275050000</td>\n",
       "      <td>461.839996</td>\n",
       "      <td>0</td>\n",
       "      <td>0.997157</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.996617</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.000283</td>\n",
       "      <td>32.0</td>\n",
       "      <td>1.028047</td>\n",
       "      <td>127.0</td>\n",
       "      <td>1.176082</td>\n",
       "      <td>512.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1993-12-15 00:00:00-05:00</th>\n",
       "      <td>463.059998</td>\n",
       "      <td>463.690002</td>\n",
       "      <td>461.839996</td>\n",
       "      <td>461.839996</td>\n",
       "      <td>331770000</td>\n",
       "      <td>463.339996</td>\n",
       "      <td>1</td>\n",
       "      <td>0.998681</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.995899</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.997329</td>\n",
       "      <td>32.0</td>\n",
       "      <td>1.025151</td>\n",
       "      <td>126.0</td>\n",
       "      <td>1.172676</td>\n",
       "      <td>512.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1993-12-16 00:00:00-05:00</th>\n",
       "      <td>461.859985</td>\n",
       "      <td>463.980011</td>\n",
       "      <td>461.859985</td>\n",
       "      <td>463.339996</td>\n",
       "      <td>284620000</td>\n",
       "      <td>466.380005</td>\n",
       "      <td>1</td>\n",
       "      <td>1.001621</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.999495</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.000311</td>\n",
       "      <td>32.0</td>\n",
       "      <td>1.028274</td>\n",
       "      <td>127.0</td>\n",
       "      <td>1.176163</td>\n",
       "      <td>513.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1993-12-17 00:00:00-05:00</th>\n",
       "      <td>463.339996</td>\n",
       "      <td>466.380005</td>\n",
       "      <td>463.339996</td>\n",
       "      <td>466.380005</td>\n",
       "      <td>363750000</td>\n",
       "      <td>465.850006</td>\n",
       "      <td>0</td>\n",
       "      <td>1.003270</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.004991</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.006561</td>\n",
       "      <td>32.0</td>\n",
       "      <td>1.034781</td>\n",
       "      <td>128.0</td>\n",
       "      <td>1.183537</td>\n",
       "      <td>514.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1993-12-20 00:00:00-05:00</th>\n",
       "      <td>466.380005</td>\n",
       "      <td>466.899994</td>\n",
       "      <td>465.529999</td>\n",
       "      <td>465.850006</td>\n",
       "      <td>255900000</td>\n",
       "      <td>465.299988</td>\n",
       "      <td>0</td>\n",
       "      <td>0.999431</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.003784</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.005120</td>\n",
       "      <td>32.0</td>\n",
       "      <td>1.033359</td>\n",
       "      <td>128.0</td>\n",
       "      <td>1.181856</td>\n",
       "      <td>513.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-05 00:00:00-04:00</th>\n",
       "      <td>5520.080078</td>\n",
       "      <td>5546.299805</td>\n",
       "      <td>5480.540039</td>\n",
       "      <td>5503.410156</td>\n",
       "      <td>3521650000</td>\n",
       "      <td>5408.419922</td>\n",
       "      <td>0</td>\n",
       "      <td>0.998489</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.990079</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.001204</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1.104629</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1.268674</td>\n",
       "      <td>525.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-06 00:00:00-04:00</th>\n",
       "      <td>5507.330078</td>\n",
       "      <td>5522.470215</td>\n",
       "      <td>5402.620117</td>\n",
       "      <td>5408.419922</td>\n",
       "      <td>3822800000</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>1</td>\n",
       "      <td>0.991295</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.979459</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.983825</td>\n",
       "      <td>34.0</td>\n",
       "      <td>1.084735</td>\n",
       "      <td>143.0</td>\n",
       "      <td>1.246199</td>\n",
       "      <td>524.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-09 00:00:00-04:00</th>\n",
       "      <td>5442.069824</td>\n",
       "      <td>5484.200195</td>\n",
       "      <td>5434.490234</td>\n",
       "      <td>5471.049805</td>\n",
       "      <td>3825940000</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>1</td>\n",
       "      <td>1.005757</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.997207</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.995066</td>\n",
       "      <td>34.0</td>\n",
       "      <td>1.096431</td>\n",
       "      <td>143.0</td>\n",
       "      <td>1.260025</td>\n",
       "      <td>525.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-10 00:00:00-04:00</th>\n",
       "      <td>5490.509766</td>\n",
       "      <td>5497.910156</td>\n",
       "      <td>5441.720215</td>\n",
       "      <td>5495.520020</td>\n",
       "      <td>3848180000</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>1</td>\n",
       "      <td>1.002231</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.002888</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.999330</td>\n",
       "      <td>34.0</td>\n",
       "      <td>1.100423</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1.265038</td>\n",
       "      <td>526.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024-09-11 00:00:00-04:00</th>\n",
       "      <td>5496.419922</td>\n",
       "      <td>5560.410156</td>\n",
       "      <td>5406.959961</td>\n",
       "      <td>5554.129883</td>\n",
       "      <td>3839450000</td>\n",
       "      <td>5595.759766</td>\n",
       "      <td>1</td>\n",
       "      <td>1.005304</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.012325</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.009613</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1.111192</td>\n",
       "      <td>144.0</td>\n",
       "      <td>1.277872</td>\n",
       "      <td>527.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7740 rows Ã— 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  Open         High          Low        Close  \\\n",
       "Date                                                                            \n",
       "1993-12-14 00:00:00-05:00   465.730011   466.119995   462.459991   463.059998   \n",
       "1993-12-15 00:00:00-05:00   463.059998   463.690002   461.839996   461.839996   \n",
       "1993-12-16 00:00:00-05:00   461.859985   463.980011   461.859985   463.339996   \n",
       "1993-12-17 00:00:00-05:00   463.339996   466.380005   463.339996   466.380005   \n",
       "1993-12-20 00:00:00-05:00   466.380005   466.899994   465.529999   465.850006   \n",
       "...                                ...          ...          ...          ...   \n",
       "2024-09-05 00:00:00-04:00  5520.080078  5546.299805  5480.540039  5503.410156   \n",
       "2024-09-06 00:00:00-04:00  5507.330078  5522.470215  5402.620117  5408.419922   \n",
       "2024-09-09 00:00:00-04:00  5442.069824  5484.200195  5434.490234  5471.049805   \n",
       "2024-09-10 00:00:00-04:00  5490.509766  5497.910156  5441.720215  5495.520020   \n",
       "2024-09-11 00:00:00-04:00  5496.419922  5560.410156  5406.959961  5554.129883   \n",
       "\n",
       "                               Volume     Tomorrow  Target  Close_Ratio_2  \\\n",
       "Date                                                                        \n",
       "1993-12-14 00:00:00-05:00   275050000   461.839996       0       0.997157   \n",
       "1993-12-15 00:00:00-05:00   331770000   463.339996       1       0.998681   \n",
       "1993-12-16 00:00:00-05:00   284620000   466.380005       1       1.001621   \n",
       "1993-12-17 00:00:00-05:00   363750000   465.850006       0       1.003270   \n",
       "1993-12-20 00:00:00-05:00   255900000   465.299988       0       0.999431   \n",
       "...                               ...          ...     ...            ...   \n",
       "2024-09-05 00:00:00-04:00  3521650000  5408.419922       0       0.998489   \n",
       "2024-09-06 00:00:00-04:00  3822800000  5471.049805       1       0.991295   \n",
       "2024-09-09 00:00:00-04:00  3825940000  5495.520020       1       1.005757   \n",
       "2024-09-10 00:00:00-04:00  3848180000  5554.129883       1       1.002231   \n",
       "2024-09-11 00:00:00-04:00  3839450000  5595.759766       1       1.005304   \n",
       "\n",
       "                           Trend_2  Close_Ratio_5  Trend_5  Close_Ratio_60  \\\n",
       "Date                                                                         \n",
       "1993-12-14 00:00:00-05:00      1.0       0.996617      1.0        1.000283   \n",
       "1993-12-15 00:00:00-05:00      0.0       0.995899      1.0        0.997329   \n",
       "1993-12-16 00:00:00-05:00      1.0       0.999495      2.0        1.000311   \n",
       "1993-12-17 00:00:00-05:00      2.0       1.004991      3.0        1.006561   \n",
       "1993-12-20 00:00:00-05:00      1.0       1.003784      2.0        1.005120   \n",
       "...                            ...            ...      ...             ...   \n",
       "2024-09-05 00:00:00-04:00      0.0       0.990079      1.0        1.001204   \n",
       "2024-09-06 00:00:00-04:00      0.0       0.979459      1.0        0.983825   \n",
       "2024-09-09 00:00:00-04:00      1.0       0.997207      1.0        0.995066   \n",
       "2024-09-10 00:00:00-04:00      2.0       1.002888      2.0        0.999330   \n",
       "2024-09-11 00:00:00-04:00      2.0       1.012325      3.0        1.009613   \n",
       "\n",
       "                           Trend_60  Close_Ratio_250  Trend_250  \\\n",
       "Date                                                              \n",
       "1993-12-14 00:00:00-05:00      32.0         1.028047      127.0   \n",
       "1993-12-15 00:00:00-05:00      32.0         1.025151      126.0   \n",
       "1993-12-16 00:00:00-05:00      32.0         1.028274      127.0   \n",
       "1993-12-17 00:00:00-05:00      32.0         1.034781      128.0   \n",
       "1993-12-20 00:00:00-05:00      32.0         1.033359      128.0   \n",
       "...                             ...              ...        ...   \n",
       "2024-09-05 00:00:00-04:00      35.0         1.104629      144.0   \n",
       "2024-09-06 00:00:00-04:00      34.0         1.084735      143.0   \n",
       "2024-09-09 00:00:00-04:00      34.0         1.096431      143.0   \n",
       "2024-09-10 00:00:00-04:00      34.0         1.100423      144.0   \n",
       "2024-09-11 00:00:00-04:00      35.0         1.111192      144.0   \n",
       "\n",
       "                           Close_Ratio_1000  Trend_1000  \n",
       "Date                                                     \n",
       "1993-12-14 00:00:00-05:00          1.176082       512.0  \n",
       "1993-12-15 00:00:00-05:00          1.172676       512.0  \n",
       "1993-12-16 00:00:00-05:00          1.176163       513.0  \n",
       "1993-12-17 00:00:00-05:00          1.183537       514.0  \n",
       "1993-12-20 00:00:00-05:00          1.181856       513.0  \n",
       "...                                     ...         ...  \n",
       "2024-09-05 00:00:00-04:00          1.268674       525.0  \n",
       "2024-09-06 00:00:00-04:00          1.246199       524.0  \n",
       "2024-09-09 00:00:00-04:00          1.260025       525.0  \n",
       "2024-09-10 00:00:00-04:00          1.265038       526.0  \n",
       "2024-09-11 00:00:00-04:00          1.277872       527.0  \n",
       "\n",
       "[7740 rows x 17 columns]"
      ]
     },
     "execution_count": 117,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp500"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "98920955-579a-4a40-916c-8ee2d0297021",
   "metadata": {},
   "source": [
    "### Improving The Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "id": "17866166-f60f-4f3a-a047-431a98507fcf",
   "metadata": {},
   "outputs": [],
   "source": [
    "model = RandomForestClassifier(n_estimators=200, min_samples_split=250, random_state=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "id": "7e3dece2-f0ff-4b61-b6da-a8a1604eadbc",
   "metadata": {},
   "outputs": [],
   "source": [
    "def predict(train, test, predictors, model):\n",
    "    model.fit(train[predictors], train['Target'])\n",
    "    preds = model.predict_proba(test[predictors])[:,1] #returning the probability the stock price goes up\n",
    "    preds[preds >= .6] =1  # 60% custom threshold so the model has to be more confident the price will go up to show it \n",
    "    preds[preds < .6] =0\n",
    "    preds = pd.Series(preds, index=test.index, name='Predictions')\n",
    "    combined = pd.concat([test['Target'], preds], axis=1)\n",
    "    return combined "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "4846d114-4728-47f7-a4ca-e77376189970",
   "metadata": {},
   "outputs": [],
   "source": [
    "predictions = backtest(sp500, model, new_predictors)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "id": "1df3f8dc-f82a-43e4-8366-aab558f57a2d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Predictions\n",
       "0.0    4908\n",
       "1.0     332\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 126,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predictions['Predictions'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "id": "4551be87-14d6-475a-9e28-1e225bbbd18e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.5903614457831325"
      ]
     },
     "execution_count": 128,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "precision_score(predictions['Target'], predictions['Predictions'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "id": "6231a3a2-c147-48ab-94c9-1dfc6b05750d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#To extend the model: look at prices of other markets, news articles, add in key stocks/sectors such as tech, try increasing resolution (tick data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed0e7222-b1da-498e-82c2-9f2676251f7a",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.19"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
